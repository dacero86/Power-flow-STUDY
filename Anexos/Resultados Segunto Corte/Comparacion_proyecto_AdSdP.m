%% Newton Rapson
iNR = 3;
NRP = [-4.0,3.0,0.2;0.0084145283040015783626586198806763,-0.004837809599507636448834091424942,-0.10395267078044589936780539574102;0.0000041156156385113717988133430480957,-0.0000020426593323463748674839735031128,-0.0001408027462687713726730009966559 ;-0.0000000000071054273576010018587112426757812, 0.0000000000046611603465862572193145751953125, -0.00000000026000882815407798692678852277294];

%% Newton Rapson modificado 

iNRM = 3;
NRM = [-4.0,3.0,0.2;0.0084145283040015783626586198806763,-0.004837809599507636448834091424942,-0.10395267078092729207128286361694;-0.0000094966723054312751628458499908447,0.0000064504463921366550493985414505005,0.0001253145982407950775883165306368;0.0000000079540996011928655207157135009766,-0.0000000049632262744125910103321075439453,-0.00000015562680227456770609001379668257];

%% Newton Rapson desacoplado

iNRD = 4;
NRD = [-4.0,3.0,0.2;0.0084145283040015783626586198806763,-0.004837809599507636448834091424942,-0.10395267078092729207128286361694;-0.0053095218374323849275242537260056,0.003313206347968389309244230389595,0.00054171481856714331915014781770878;0.000027735317871702136471867561340332,-0.000017303859976891544647514820098877,-0.00026659570349246014542288207849197;-0.000013653630446697206934913992881775,0.000008518903655385656747967004776001,0.0000017214121843858449893704953836959];

%% Newton Rapson desacoplado rapido
iNRDR = 4;
NRDR = [-4.0,3.0,0.2;0.12043863122340781046659685671329,-0.10730894721541517355944961309433,-0.10427977484687289688736200332642;-0.0084488979235091132835577809601091,0.0068442865024274102125900753890164,0.0043475786853215403482408873969689;0.00044357885520022316550026175718813,-0.00036205337449010666084348031290574,-0.00035052826546372317650934746779967;-0.000029398464513026491967684350470336,0.000022924972532222843979443638318116,0.000015573751431222429553180575112492];

%% Grafica Comparación Variables criticas 

NRP1= abs(NRP(:,3));
NRM2=abs(NRM(:,3));
NRD3=abs(NRD(:,3));
NRDR4=abs(NRDR(:,3));

%%  Grafica
y1 = 0:length(NRP1)-1;
y2 = 0:length(NRM2)-1;
y3 = 0:length(NRD3)-1;
y4 = 0:length(NRDR4)-1;
y = 0:10;
plot(y1,NRP1,'--')
ep=ones(11,1)*0.001;
hold on


plot(y2,NRM2,':')
plot(y3,NRD3,'g:')
plot(y4,NRDR4,':*')

plot (y,ep,'r');

xlim([0 4.1])
ylim([0 0.2])
xlabel('iteraciones')
ylabel('Variables Criticas')
title('Comparación entre metodos')

legend('NRP Q2','NRM Q2','NRD P2','NRDR P2')

hold off




